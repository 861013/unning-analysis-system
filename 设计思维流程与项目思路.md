# 设计思维流程与跑步分析系统项目思路

体育工程学院  
2023级数据2班

| 姓名 | 学号 | 负责部分 |
|------|------|----------|
| 常洙涵 | 20230125 | ppt制作 |
| 杨小璐 | 20230125 | 演讲汇报 |
| 张蕊 | 20230125 | ppt制作 |
| 赵若楠 | 2023012510 | 撰写报告 |

## 项目技术栈说明（全部开源免费）

**重要说明：本项目使用的所有技术均为开源免费软件，支持Ubuntu 24和Windows 11系统，以及微信小程序。**

### 初学者简化版本说明

**如果以数据为主，以下功能可以暂时省略：**
1. ❌ **视频姿势分析**（复杂，需要AI模型，可后期添加）
2. ❌ **复杂的训练计划生成**（可简化为基于规则的简单计划）
3. ❌ **高级数据可视化**（可先做基础的折线图、柱状图）
4. ❌ **多格式导出**（可先支持CSV导出）

**核心数据功能（必须保留）：**
1. ✅ **数据采集与存储**（核心功能）
2. ✅ **基础数据分析**（查询、筛选、统计）
3. ✅ **简单数据可视化**（折线图、柱状图）
4. ✅ **数据录入**（手动输入、文件上传）
5. ✅ **数据导出**（CSV格式）

**简化版MVP功能清单：**
- 数据录入（手动输入）
- 数据存储（MongoDB）
- 数据查询和筛选
- 基础图表展示（折线图、柱状图）
- CSV数据导出

### 开源免费技术清单

| 技术类别 | 技术名称 | 许可证 | 支持系统 |
|---------|---------|--------|---------|
| **前端框架** | Vue.js / React | MIT | Ubuntu 24, Windows 11 |
| **图表库** | Chart.js / ECharts / D3.js | MIT / Apache 2.0 / BSD 3-Clause | Ubuntu 24, Windows 11 |
| **CSS框架** | Bootstrap / Tailwind CSS | MIT | Ubuntu 24, Windows 11 |
| **后端运行时** | Node.js / Python 3 | MIT / PSF | Ubuntu 24, Windows 11 |
| **Web框架** | Express / Flask / FastAPI | MIT / BSD / MIT | Ubuntu 24, Windows 11 |
| **数据库** | MongoDB Community Edition | SSPL | Ubuntu 24, Windows 11 |
| **缓存** | Redis | BSD 3-Clause | Ubuntu 24, Windows 11 |
| **视频分析** | TensorFlow.js / MediaPipe | Apache 2.0 | Ubuntu 24, Windows 11 |
| **AI模型** | DeepSeek API | 免费API | Ubuntu 24, Windows 11 |
| **小程序框架** | 微信小程序原生框架 | 免费 | 微信小程序 |
| **小程序UI库** | WeUI / Vant Weapp | MIT / MIT | 微信小程序 |
| **小程序图表** | wx-charts / ECharts for 小程序 | MIT / Apache 2.0 | 微信小程序 |
| **浏览器** | Firefox / Chrome / Chromium / Edge | MPL / BSD / BSD / MIT | Ubuntu 24, Windows 11 |

**所有技术均为完全免费，无任何商业限制，可自由使用和修改。**
**注意：DeepSeek API提供免费额度，超出部分可能需要付费，但基础使用完全免费。**
**注意：微信小程序开发需要注册微信小程序账号（个人开发者免费），但开发工具和框架完全免费。**

---

## 一、设计思维流程（Design Thinking Process）

设计思维流程的五个阶段：

1. **Empathise（共情/同理心）** - 深入了解用户需求和痛点
2. **Define（定义）** - 明确问题核心和用户需求
3. **Ideate（构思）** - 发散思维，提出创新解决方案
4. **Prototype（原型）** - 快速构建可测试的原型
5. **Test（测试）** - 测试原型，收集反馈并迭代改进

---

## 二、基于设计思维的跑步分析系统项目思路

### 阶段一：Empathise（共情）- 理解用户需求

#### 1.1 用户痛点分析
- **数据分散问题**：用户拥有多个设备（小米手环10、体脂秤S400、跑步机），数据分散在不同平台，难以统一管理
- **缺乏综合分析**：各设备数据独立，无法进行跨设备的数据关联分析
- **姿势分析缺失**：现有设备无法分析跑步姿势，可能导致运动损伤
- **训练计划缺失**：缺乏基于历史数据的个性化训练计划推荐
- **数据可视化不足**：用户难以直观理解自己的运动表现和身体变化趋势

#### 1.2 目标用户画像
- 跑步爱好者（初级到高级）
- 关注健康数据的人群
- 希望通过科学训练提升跑步表现的用户
- 需要姿势纠正和运动损伤预防的用户

---

### 阶段二：Define（定义）- 明确问题核心

#### 2.1 核心问题定义
**如何构建一个基于NoSQL数据库的跑步分析系统，整合多设备数据，提供姿势分析、数据分析和个性化训练计划？**

#### 2.2 功能需求定义
1. **数据采集与存储**
   - 整合小米手环10、体脂秤S400、跑步机的数据
   - 支持手动录入和自动导入
   - 使用NoSQL数据库存储非结构化数据

2. **视频姿势分析**
   - 支持正面、侧面、后面三个角度的视频上传
   - 自动识别和分析跑步姿势
   - 提供姿势改进建议

3. **数据分析与可视化**
   - 多维度数据分析（心率、配速、卡路里、体脂率等）
   - 趋势分析和对比分析
   - 数据可视化图表展示

4. **训练计划生成（集成DeepSeek AI）**
   - 基于历史数据生成短期训练计划（1-4周）
   - 基于长期数据生成长期训练计划（1-6个月）
   - 使用DeepSeek API进行科学分析和个性化训练计划生成
   - 根据用户历史数据（心率、配速、卡路里、体脂率、睡眠等）智能生成训练计划
   - 支持训练计划导出（PDF、CSV、JSON格式）
   - 个性化训练强度推荐和训练目标设定

5. **跨平台兼容性**
   - 支持Windows 11、Ubuntu 24系统（Web端）
   - 支持微信小程序（手机端）
   - 基于Web技术实现，无需安装客户端
   - 所有技术栈均为开源免费软件

6. **微信小程序端功能**
   - 数据录入（手动输入运动数据）
   - 数据查看（查看历史数据）
   - 数据可视化（图表展示）
   - 数据同步（与Web端数据同步）
   - 训练计划查看（查看生成的训练计划）

---

### 阶段三：Ideate（构思）- 解决方案设计

#### 3.1 技术架构设计

**技术选型原则：**
- ✅ 所有技术均为开源免费软件
- ✅ 支持Ubuntu 24和Windows 11系统
- ✅ 基于Web标准，跨平台兼容

**前端技术栈（全部开源免费）：**
- **HTML5 + CSS3 + JavaScript**：Web标准，完全免费
- **前端框架（可选）**：
  - **Vue.js**（MIT许可证，开源免费）
  - **React**（MIT许可证，开源免费）
- **视频处理**：WebRTC API / MediaRecorder API（浏览器原生API，免费）
- **图表可视化**：
  - **Chart.js**（MIT许可证，开源免费）
  - **ECharts**（Apache 2.0许可证，开源免费）
  - **D3.js**（BSD 3-Clause许可证，开源免费）
- **响应式设计框架**：
  - **Bootstrap**（MIT许可证，开源免费）
  - **Tailwind CSS**（MIT许可证，开源免费）

**后端技术栈（全部开源免费）：**
- **运行时环境**：
  - **Node.js**（MIT许可证，开源免费）- 支持Ubuntu 24和Windows 11
  - **Python 3**（PSF许可证，开源免费）- 支持Ubuntu 24和Windows 11
- **Web框架**：
  - **Express.js**（MIT许可证，开源免费）
  - **Flask**（BSD许可证，开源免费）
  - **FastAPI**（MIT许可证，开源免费）
- **NoSQL数据库（全部开源免费）**：
  - **MongoDB Community Edition**（SSPL许可证，开源免费）- 支持Ubuntu 24和Windows 11
  - **Redis**（BSD 3-Clause许可证，开源免费）- 支持Ubuntu 24和Windows 11
  - **Cassandra**（Apache 2.0许可证，开源免费，可选）- 支持Ubuntu 24和Windows 11

**视频分析技术（全部开源免费）：**
- **前端分析方案**：
  - **TensorFlow.js**（Apache 2.0许可证，开源免费）- 浏览器内运行，支持Ubuntu 24和Windows 11
  - **OpenCV.js**（Apache 2.0许可证，开源免费）- 浏览器内运行，支持Ubuntu 24和Windows 11
- **后端分析方案**：
  - **MediaPipe**（Apache 2.0许可证，开源免费）- Python库，支持Ubuntu 24和Windows 11
  - **OpenPose**（Apache 2.0许可证，开源免费）- C++库，支持Ubuntu 24和Windows 11

**推荐技术组合：**
- **Web前端**：Vue.js + Chart.js + Bootstrap
- **小程序前端**：微信小程序原生框架 + WeUI + wx-charts
- **后端**：Python + FastAPI（统一API，同时服务Web端和小程序端）
- **数据库**：MongoDB Community Edition + Redis
- **视频分析**：TensorFlow.js（前端）+ MediaPipe（后端，可选）

**架构说明：**
- Web端和小程序端共享同一个后端API
- 数据统一存储在MongoDB中
- 通过RESTful API进行数据交互

**数据存储结构设计：**

```javascript
// MongoDB文档结构示例
{
  userId: "user123",
  timestamp: ISODate("2024-01-15T10:30:00Z"),
  
  // 基础信息
  basicInfo: {
    gender: "male",
    age: 28,
    height: 175, // cm
    weight: 70,  // kg
    bodyFat: 15, // %
    muscleMass: 55, // kg
    waterContent: 50 // %
  },
  
  // 手环数据
  bandData: {
    heartRate: 145, // bpm
    pace: 5.5, // min/km
    trainingLoad: 85,
    calories: 350,
    sleep: {
      duration: 7.5, // hours
      deepSleep: 2.0,
      lightSleep: 4.5,
      remSleep: 1.0
    }
  },
  
  // 跑步机数据
  treadmillData: {
    speed: 10.5, // km/h
    incline: 2.0, // %
    duration: 30, // minutes
    distance: 5.25 // km
  },
  
  // 视频分析结果
  postureAnalysis: {
    frontView: {
      videoUrl: "path/to/video",
      analysisResult: {
        kneeAlignment: "good",
        footStrike: "midfoot",
        armSwing: "optimal",
        score: 85
      }
    },
    sideView: {
      videoUrl: "path/to/video",
      analysisResult: {
        posture: "upright",
        strideLength: "optimal",
        cadence: 180,
        score: 88
      }
    },
    backView: {
      videoUrl: "path/to/video",
      analysisResult: {
        hipAlignment: "good",
        shoulderLevel: "even",
        score: 82
      }
    }
  }
}
```

#### 3.2 功能模块设计

**模块1：数据录入模块**
- 手动输入表单（基础信息、运动数据）
- 文件上传（CSV/JSON格式的设备数据导出）
- 视频上传（支持正面/侧面/后面三个角度）
- 数据验证和格式化

**模块2：视频分析模块**
- 视频上传和预览
- 实时或离线姿势分析
- 关键点检测（关节位置）
- 姿势评分和改进建议

**模块3：数据分析模块**
- 数据查询和筛选
- 多维度数据对比
- 趋势图表（折线图、柱状图、热力图）
- 数据导出功能

**模块4：训练计划模块（集成DeepSeek AI）**
- 基于历史数据的智能分析
- **DeepSeek API集成**：
  - 调用DeepSeek API，输入用户历史数据（心率、配速、卡路里、体脂率、睡眠、训练负荷等）
  - 使用AI模型分析数据趋势和用户能力水平
  - 生成科学的个性化训练计划（包含训练强度、频率、时长、目标等）
- 训练计划生成算法（结合DeepSeek AI和规则引擎）
- 计划展示和编辑（可视化展示训练计划，支持手动调整）
- 计划执行跟踪（记录计划执行情况，反馈给AI模型优化后续计划）
- **训练计划导出功能**：
  - 支持导出为PDF格式（包含详细训练计划、图表、说明）
  - 支持导出为CSV格式（便于在Excel等工具中查看和编辑）
  - 支持导出为JSON格式（便于程序化处理和导入其他系统）

**模块5：用户管理模块**
- 用户注册/登录
- 个人资料管理
- 数据隐私设置

**模块6：微信小程序端模块（简化版）**
- **数据录入**：
  - 手动输入运动数据（心率、配速、卡路里等）
  - 基础信息录入（身高、体重、体脂率等）
  - 数据验证和格式化
- **数据查看**：
  - 历史数据列表展示
  - 数据详情查看
  - 数据筛选（按日期、类型）
- **数据可视化**：
  - 折线图展示（心率、配速趋势）
  - 柱状图展示（卡路里、训练负荷）
  - 简单统计信息（平均值、最大值、最小值）
- **数据同步**：
  - 与Web端数据同步
  - 离线数据缓存
  - 数据上传和下载
- **训练计划查看**：
  - 查看生成的训练计划
  - 计划详情展示
  - 计划执行记录

**注意：小程序端为简化版本，复杂功能（视频分析、高级训练计划生成）在Web端实现。**

---

### 阶段四：Prototype（原型）- 快速实现

#### 4.1 最小可行产品（MVP）功能

**Web端MVP功能（初学者简化版）：**
1. 基础数据录入（手动输入）
2. 简单的数据可视化（折线图展示心率、配速趋势）
3. 数据查询和筛选
4. CSV数据导出
5. 基础训练计划生成（基于简单规则，可选）

**小程序端MVP功能：**
1. 数据录入（手动输入运动数据）
2. 数据查看（历史数据列表和详情）
3. 简单图表展示（折线图、柱状图）
4. 数据同步（与Web端同步）

**可省略的功能（后期添加）：**
- ❌ 视频姿势分析（复杂，需要AI模型）
- ❌ 复杂的训练计划生成（可简化为基于规则）
- ❌ 高级数据可视化（可先做基础的）
- ❌ 多格式导出（可先支持CSV）

#### 4.2 原型开发步骤
1. **第一周**：搭建基础框架
   - 创建HTML页面结构
   - 设计UI界面
   - 配置NoSQL数据库连接

2. **第二周**：实现数据录入
   - 开发数据录入表单
   - 实现数据存储到MongoDB
   - 数据验证功能

3. **第三周**：实现数据分析
   - 数据查询功能
   - 基础图表展示
   - 数据筛选功能

4. **第四周**：实现视频分析（可选，初学者可省略）
   - 视频上传功能
   - 集成姿势识别API或库
   - 分析结果展示

5. **第五周**：实现训练计划（集成DeepSeek AI，可选）
   - 集成DeepSeek API（配置API密钥，实现API调用）
   - 实现历史数据收集和格式化（准备输入给DeepSeek的数据）
   - 训练计划生成算法（结合DeepSeek AI和规则引擎）
   - 计划展示界面（可视化展示训练计划）
   - 计划编辑功能（支持手动调整AI生成的计划）
   - 训练计划导出功能（PDF、CSV、JSON格式）

6. **第六周**：实现微信小程序端（初学者简化版）
   - 搭建小程序项目结构
   - 实现数据录入页面（手动输入运动数据）
   - 实现数据列表页面（查看历史数据）
   - 实现图表展示页面（折线图、柱状图）
   - 实现数据同步功能（与Web端同步）
   - 配置小程序与后端API对接

7. **第七周**：测试和优化
   - Web端跨平台测试（Ubuntu 24、Windows 11）
   - 小程序端测试（iOS、Android）
   - 性能优化
   - 用户体验改进

---

### 阶段五：Test（测试）- 验证与迭代

#### 5.1 测试计划
1. **功能测试**
   - 数据录入准确性
   - 视频分析准确性
   - 训练计划合理性

2. **性能测试**
   - 大量数据查询性能
   - 视频处理速度
   - 页面加载速度

3. **兼容性测试（全部开源免费浏览器）**
   - **Windows 11系统测试**：
     - Microsoft Edge（Chromium内核，开源免费）
     - Google Chrome（开源免费）
     - Mozilla Firefox（开源免费）
   - **Ubuntu 24系统测试**：
     - Mozilla Firefox（开源免费，系统默认）
     - Google Chrome（开源免费）
     - Chromium（开源免费，系统自带）

4. **用户体验测试**
   - 界面易用性
   - 操作流程顺畅性
   - 反馈收集和改进

#### 5.2 迭代改进方向
- 根据用户反馈优化界面设计
- 改进姿势分析算法准确性
- 优化训练计划生成算法
- 增加更多数据可视化方式
- 支持更多设备数据导入

---

## 三、项目技术实现要点

### 3.0 开发环境要求（全部开源免费）

**操作系统支持：**
- ✅ Ubuntu 24.04 LTS（开源免费）
- ✅ Windows 11（用户已拥有）

**开发工具（全部开源免费）：**
- **代码编辑器**：
  - **Visual Studio Code**（MIT许可证，开源免费）- 支持Ubuntu 24和Windows 11
  - **Vim / Neovim**（Vim许可证，开源免费）- 支持Ubuntu 24和Windows 11
- **版本控制**：
  - **Git**（GPL 2.0许可证，开源免费）- 支持Ubuntu 24和Windows 11
- **包管理器**：
  - **npm**（Node.js自带，开源免费）- 支持Ubuntu 24和Windows 11
  - **pip**（Python自带，开源免费）- 支持Ubuntu 24和Windows 11
- **数据库管理工具**：
  - **MongoDB Compass**（SSPL许可证，开源免费）- 支持Ubuntu 24和Windows 11
  - **Redis Insight**（Redis自带，开源免费）- 支持Ubuntu 24和Windows 11
- **小程序开发工具**：
  - **微信开发者工具**（免费，官方工具）- 支持Windows 11和Mac（Ubuntu 24可通过Wine运行）
  - **小程序代码编辑器**：Visual Studio Code + 小程序插件（开源免费）

**所有开发工具均为开源免费，无任何商业限制。**

**微信小程序开发准备：**
1. 注册微信小程序账号（个人开发者免费）
2. 下载微信开发者工具（免费）
3. 获取AppID（用于小程序开发）
4. 配置服务器域名（用于API调用）

---

### 3.1 NoSQL数据库选择理由（全部开源免费）

- **MongoDB Community Edition**（SSPL许可证，开源免费）
  - 适合存储文档型数据，灵活的数据结构，易于扩展
  - 支持Ubuntu 24和Windows 11
  - 完全免费，无功能限制
- **Redis**（BSD 3-Clause许可证，开源免费）
  - 用于缓存和实时数据，提高查询性能
  - 支持Ubuntu 24和Windows 11
  - 完全免费，无功能限制
- **Cassandra**（Apache 2.0许可证，开源免费，可选）
  - 处理大量时序数据，适合大规模部署
  - 支持Ubuntu 24和Windows 11
  - 完全免费，无功能限制
- 所有数据库均支持水平扩展，适合处理大量运动数据

### 3.2 跨平台实现方案（全部开源免费）

**方案一：纯Web应用（推荐）**
- 使用Web技术（HTML5/CSS3/JavaScript）
- 通过浏览器访问，无需安装
- 支持Ubuntu 24和Windows 11上的所有主流浏览器：
  - **Ubuntu 24**：Firefox、Chrome、Chromium（全部开源免费）
  - **Windows 11**：Edge、Chrome、Firefox（全部开源免费）
- 优点：零安装，跨平台兼容性最好

**方案二：桌面应用打包（可选）**
- **Electron**（MIT许可证，开源免费）- 支持Ubuntu 24和Windows 11
- **Tauri**（Apache 2.0许可证，开源免费）- 支持Ubuntu 24和Windows 11
- 优点：可离线使用，更像原生应用
- 缺点：需要打包和分发

**推荐方案**：纯Web应用，通过浏览器访问，确保在Ubuntu 24和Windows 11上都能完美运行

**方案三：微信小程序（手机端）**
- 使用微信小程序原生框架（免费）
- 通过微信打开，无需安装
- 支持iOS和Android系统
- 优点：用户使用方便，无需下载安装
- 缺点：需要微信小程序账号（个人开发者免费）

**推荐架构：**
- Web端：用于复杂功能（视频分析、高级训练计划生成）
- 小程序端：用于基础功能（数据录入、查看、简单图表）
- 后端API：统一服务Web端和小程序端

### 3.3 微信小程序开发方案（全部开源免费）

**小程序技术栈：**
- **框架**：微信小程序原生框架（免费）
- **UI库**：
  - **WeUI**（MIT许可证，开源免费）- 微信官方UI库
  - **Vant Weapp**（MIT许可证，开源免费）- 有赞开源UI库
- **图表库**：
  - **wx-charts**（MIT许可证，开源免费）- 小程序图表库
  - **ECharts for 小程序**（Apache 2.0许可证，开源免费）- ECharts小程序版本
- **网络请求**：wx.request（小程序原生API，免费）

**小程序与后端API对接：**

1. **API配置**
   ```javascript
   // app.js - 小程序全局配置
   App({
     globalData: {
       apiBaseUrl: 'https://your-api-domain.com/api', // 后端API地址
       userInfo: null
     },
     
     onLaunch() {
       // 小程序启动时初始化
     }
   })
   ```

2. **API请求封装**
   ```javascript
   // utils/api.js - API请求工具
   const app = getApp()
   
   function request(url, method, data) {
     return new Promise((resolve, reject) => {
       wx.request({
         url: app.globalData.apiBaseUrl + url,
         method: method,
         data: data,
         header: {
           'Content-Type': 'application/json',
           'Authorization': 'Bearer ' + wx.getStorageSync('token') // 用户token
         },
         success: (res) => {
           if (res.statusCode === 200) {
             resolve(res.data)
           } else {
             reject(res)
           }
         },
         fail: (err) => {
           reject(err)
         }
       })
     })
   }
   
   // 导出API方法
   module.exports = {
     // 获取运动数据
     getExerciseData: (params) => request('/exercise', 'GET', params),
     
     // 提交运动数据
     submitExerciseData: (data) => request('/exercise', 'POST', data),
     
     // 获取训练计划
     getTrainingPlan: (params) => request('/training-plan', 'GET', params),
     
     // 获取统计数据
     getStatistics: (params) => request('/statistics', 'GET', params)
   }
   ```

3. **数据录入页面示例**
   ```javascript
   // pages/input/input.js
   const api = require('../../utils/api.js')
   
   Page({
     data: {
       heartRate: '',
       pace: '',
       calories: '',
       date: ''
     },
     
     // 提交数据
     submitData() {
       const data = {
         heartRate: this.data.heartRate,
         pace: this.data.pace,
         calories: this.data.calories,
         date: this.data.date || new Date().toISOString()
       }
       
       api.submitExerciseData(data).then(res => {
         wx.showToast({
           title: '提交成功',
           icon: 'success'
         })
         // 返回上一页
         wx.navigateBack()
       }).catch(err => {
         wx.showToast({
           title: '提交失败',
           icon: 'error'
         })
       })
     }
   })
   ```

4. **数据可视化页面示例**
   ```javascript
   // pages/chart/chart.js
   const api = require('../../utils/api.js')
   const wxCharts = require('../../utils/wx-charts.js') // wx-charts库
   
   Page({
     data: {
       chartData: []
     },
     
     onLoad() {
       this.loadChartData()
     },
     
     // 加载图表数据
     loadChartData() {
       api.getStatistics({ type: 'heartRate' }).then(res => {
         this.drawChart(res.data)
       })
     },
     
     // 绘制图表
     drawChart(data) {
       const chart = new wxCharts({
         canvasId: 'chart',
         type: 'line',
         categories: data.dates,
         series: [{
           name: '心率',
           data: data.values
         }],
         width: 375,
         height: 200
       })
     }
   })
   ```

5. **小程序页面结构**
   ```
   miniprogram/
   ├── app.js              # 小程序入口
   ├── app.json            # 小程序配置
   ├── app.wxss            # 全局样式
   ├── pages/              # 页面目录
   │   ├── index/          # 首页
   │   ├── input/          # 数据录入页
   │   ├── list/           # 数据列表页
   │   ├── chart/          # 图表展示页
   │   └── plan/           # 训练计划页
   ├── components/         # 组件目录
   ├── utils/              # 工具函数
   │   ├── api.js          # API请求封装
   │   └── wx-charts.js    # 图表库
   └── images/             # 图片资源
   ```

6. **小程序配置（app.json）**
   ```json
   {
     "pages": [
       "pages/index/index",
       "pages/input/input",
       "pages/list/list",
       "pages/chart/chart",
       "pages/plan/plan"
     ],
     "window": {
       "navigationBarTitleText": "跑步分析",
       "navigationBarBackgroundColor": "#ffffff",
       "navigationBarTextStyle": "black"
     },
     "tabBar": {
       "list": [
         {
           "pagePath": "pages/index/index",
           "text": "首页"
         },
         {
           "pagePath": "pages/input/input",
           "text": "录入"
         },
         {
           "pagePath": "pages/list/list",
           "text": "数据"
         },
         {
           "pagePath": "pages/chart/chart",
           "text": "图表"
         }
       ]
     },
     "networkTimeout": {
       "request": 10000
     }
   }
   ```

**小程序开发注意事项：**
1. **服务器域名配置**：需要在微信小程序后台配置服务器域名（用于API调用）
2. **数据存储**：使用wx.setStorageSync和wx.getStorageSync进行本地存储
3. **用户登录**：使用wx.login获取code，通过后端API换取用户token
4. **数据同步**：定期调用API同步数据，支持离线缓存
5. **性能优化**：使用wx:if和hidden控制页面渲染，避免不必要的渲染

**技术优势：**
- ✅ 微信小程序框架完全免费
- ✅ UI库和图表库均为开源免费
- ✅ 开发工具免费
- ✅ 个人开发者注册免费
- ✅ 与Web端共享后端API，降低开发成本

### 3.4 视频分析实现方案（全部开源免费）

**方案A：前端分析（推荐用于简单分析）**
- **TensorFlow.js**（Apache 2.0许可证，开源免费）
  - 浏览器内运行，无需服务器
  - 支持Ubuntu 24和Windows 11上的所有现代浏览器
  - 优点：响应快，隐私保护好（数据不上传）
  - 缺点：受浏览器性能限制，适合简单姿势检测

**方案B：后端分析（推荐用于复杂分析）**
- **Python + MediaPipe**（Apache 2.0许可证，开源免费）
  - 支持Ubuntu 24和Windows 11
  - 优点：分析准确，性能好，功能强大
  - 缺点：需要服务器资源，数据需要上传
- **Python + OpenPose**（Apache 2.0许可证，开源免费）
  - 支持Ubuntu 24和Windows 11
  - 优点：专业级姿势识别，准确度高
  - 缺点：配置复杂，资源消耗大

**推荐方案**：混合方案
- 简单姿势检测：使用TensorFlow.js在前端实时分析
- 复杂姿势分析：使用MediaPipe在后端进行详细分析
- 所有技术均为开源免费，支持Ubuntu 24和Windows 11

### 3.5 训练计划生成方案（集成DeepSeek AI）

**DeepSeek API集成方案：**

1. **API配置**
   - 使用DeepSeek API（提供免费额度）
   - 支持Ubuntu 24和Windows 11
   - 通过HTTP请求调用API，无需本地部署模型

2. **数据准备**
   - 从MongoDB收集用户历史数据：
     - 基础信息：性别、年龄、身高、体重、体脂率、肌肉含量
     - 运动数据：心率、配速、训练负荷、卡路里、跑步机参数
     - 健康数据：睡眠情况、水分含量
     - 姿势分析结果：跑步姿势评分
   - 数据格式化：将数据整理为JSON格式，便于AI分析

3. **AI提示词设计（Prompt Engineering）**
   ```python
   # 示例提示词结构
   prompt = f"""
   你是一位专业的跑步训练教练。请根据以下用户数据，生成一份科学的个性化训练计划。
   
   用户基本信息：
   - 性别：{gender}
   - 年龄：{age}
   - 身高：{height}cm
   - 体重：{weight}kg
   - 体脂率：{bodyFat}%
   
   历史运动数据（最近30天）：
   - 平均心率：{avgHeartRate}bpm
   - 平均配速：{avgPace}min/km
   - 平均训练负荷：{avgTrainingLoad}
   - 平均卡路里消耗：{avgCalories}kcal
   - 平均睡眠时长：{avgSleep}小时
   
   训练目标：{trainingGoal}
   计划时长：{planDuration}周
   
   请生成一份详细的训练计划，包括：
   1. 每周训练安排（训练日、休息日）
   2. 每次训练的具体内容（热身、主训练、放松）
   3. 训练强度（心率区间、配速区间）
   4. 训练时长和距离
   5. 训练建议和注意事项
   """
   ```

4. **API调用实现**
   - **Python实现示例**：
     ```python
     import requests
     
     def generate_training_plan(user_data, api_key):
         url = "https://api.deepseek.com/v1/chat/completions"
         headers = {
             "Authorization": f"Bearer {api_key}",
             "Content-Type": "application/json"
         }
         
         prompt = format_prompt(user_data)
         
         data = {
             "model": "deepseek-chat",
             "messages": [
                 {"role": "system", "content": "你是一位专业的跑步训练教练。"},
                 {"role": "user", "content": prompt}
             ],
             "temperature": 0.7,
             "max_tokens": 2000
         }
         
         response = requests.post(url, headers=headers, json=data)
         return response.json()
     ```
   
   - **Node.js实现示例**：
     ```javascript
     const axios = require('axios');
     
     async function generateTrainingPlan(userData, apiKey) {
         const url = 'https://api.deepseek.com/v1/chat/completions';
         const prompt = formatPrompt(userData);
         
         const response = await axios.post(url, {
             model: 'deepseek-chat',
             messages: [
                 { role: 'system', content: '你是一位专业的跑步训练教练。' },
                 { role: 'user', content: prompt }
             ],
             temperature: 0.7,
             max_tokens: 2000
         }, {
             headers: {
                 'Authorization': `Bearer ${apiKey}`,
                 'Content-Type': 'application/json'
             }
         });
         
         return response.data;
     }
     ```

5. **训练计划存储**
   - 将AI生成的训练计划存储到MongoDB
   - 支持计划版本管理（保存历史计划）
   - 关联用户数据和计划执行情况

6. **训练计划导出功能**

   **PDF导出（使用开源库）：**
   - **Python方案**：使用`reportlab`或`weasyprint`（开源免费）
   - **Node.js方案**：使用`pdfkit`或`puppeteer`（开源免费）
   - 导出内容：训练计划详情、图表、说明文字

   **CSV导出：**
   - 使用Python的`csv`模块或Node.js的`csv-writer`（开源免费）
   - 导出格式：日期、训练内容、强度、时长、距离等

   **JSON导出：**
   - 直接序列化训练计划对象
   - 便于程序化处理和导入其他系统

   **实现示例（Python）：**
   ```python
   from reportlab.lib.pagesizes import A4
   from reportlab.pdfgen import canvas
   import csv
   import json
   
   def export_plan_to_pdf(plan, filename):
       """导出训练计划为PDF"""
       c = canvas.Canvas(filename, pagesize=A4)
       # 添加训练计划内容
       c.drawString(100, 800, f"训练计划：{plan['title']}")
       # ... 更多内容
       c.save()
   
   def export_plan_to_csv(plan, filename):
       """导出训练计划为CSV"""
       with open(filename, 'w', newline='', encoding='utf-8') as f:
           writer = csv.writer(f)
           writer.writerow(['日期', '训练内容', '强度', '时长', '距离'])
           for day in plan['schedule']:
               writer.writerow([day['date'], day['content'], 
                               day['intensity'], day['duration'], day['distance']])
   
   def export_plan_to_json(plan, filename):
       """导出训练计划为JSON"""
       with open(filename, 'w', encoding='utf-8') as f:
           json.dump(plan, f, ensure_ascii=False, indent=2)
   ```

7. **计划优化和反馈**
   - 记录用户执行计划的情况
   - 将执行反馈数据输入DeepSeek API，优化后续计划
   - 实现持续学习和改进机制

**技术优势：**
- ✅ DeepSeek API提供免费额度，基础使用完全免费
- ✅ 支持Ubuntu 24和Windows 11
- ✅ 无需本地部署大型AI模型，节省资源
- ✅ API调用简单，易于集成
- ✅ 支持多种导出格式，满足不同需求

---

## 四、项目交付物清单

1. **源代码**
   - 前端HTML/CSS/JavaScript文件
   - 后端API代码
   - 数据库配置和脚本

2. **文档**
   - 项目需求文档
   - 技术设计文档
   - 用户使用手册
   - API接口文档

3. **演示**
   - 功能演示视频
   - 项目演示PPT

---

## 五、时间规划建议

- **第1-2周**：需求分析和系统设计
- **第3-4周**：基础框架搭建和数据录入功能（Web端）
- **第5-6周**：数据分析和可视化功能（Web端）
- **第7-8周**：微信小程序端开发（数据录入、查看、图表）
- **第9-10周**：训练计划生成功能（集成DeepSeek AI和导出功能，可选）
- **第11-12周**：测试、优化和文档编写

**初学者简化版时间规划：**
- **第1-2周**：需求分析和系统设计
- **第3-4周**：基础框架搭建和数据录入功能（Web端）
- **第5-6周**：数据分析和可视化功能（Web端，基础图表）
- **第7-8周**：微信小程序端开发（数据录入、查看、简单图表）
- **第9-10周**：测试、优化和文档编写

---

## 六、关键成功因素

1. **数据整合**：成功整合多设备数据（小米手环10、体脂秤S400、跑步机）
2. **姿势分析准确性**：视频分析结果准确可靠（使用开源免费的TensorFlow.js和MediaPipe）
3. **训练计划科学性**：使用DeepSeek AI生成符合运动科学原理的训练计划，基于历史数据智能分析
4. **训练计划导出**：支持PDF、CSV、JSON多种格式导出，便于用户使用和分享
5. **用户体验**：界面友好，操作简便
6. **跨平台兼容性**：
   - Web端：在Ubuntu 24和Windows 11系统上都能正常运行
   - 小程序端：在iOS和Android系统上都能正常运行
7. **小程序支持**：微信小程序端功能完善，与Web端数据同步
8. **开源免费**：所有使用的技术栈均为开源免费软件，无任何商业限制
9. **技术可维护性**：使用成熟的开源技术，便于长期维护和扩展
10. **初学者友好**：提供简化版本，降低开发难度

---

## 七、初学者开发建议

### 7.1 功能优先级（以数据为主）

**第一阶段（必须实现）：**
1. ✅ 数据录入（手动输入）
2. ✅ 数据存储（MongoDB）
3. ✅ 数据查询和筛选
4. ✅ 基础图表展示（折线图、柱状图）
5. ✅ CSV数据导出

**第二阶段（可选实现）：**
1. ⚠️ 微信小程序端（数据录入、查看、图表）
2. ⚠️ 基础训练计划生成（基于简单规则）
3. ⚠️ 数据统计分析（平均值、最大值、最小值）

**第三阶段（后期添加）：**
1. ❌ 视频姿势分析（复杂，需要AI模型）
2. ❌ 复杂的训练计划生成（集成DeepSeek AI）
3. ❌ 高级数据可视化（热力图、3D图表）
4. ❌ 多格式导出（PDF、JSON）

### 7.2 微信小程序开发要点

**开发准备：**
1. 注册微信小程序账号（个人开发者免费）
2. 下载微信开发者工具（免费）
3. 获取AppID
4. 配置服务器域名（用于API调用）

**核心功能实现：**
1. **数据录入**：使用表单组件，调用后端API提交数据
2. **数据查看**：使用列表组件，调用后端API获取数据
3. **图表展示**：使用wx-charts或ECharts for 小程序
4. **数据同步**：使用wx.setStorageSync本地存储，定期同步

**技术难点：**
1. **API对接**：需要配置服务器域名，使用HTTPS协议
2. **用户登录**：使用wx.login获取code，通过后端换取token
3. **数据存储**：使用本地存储缓存数据，支持离线使用
4. **性能优化**：避免频繁请求，使用缓存机制

### 7.3 简化版开发路径

**推荐开发顺序：**
1. **第1-2周**：搭建后端API（Python + FastAPI + MongoDB）
2. **第3-4周**：开发Web端数据录入和查看功能
3. **第5-6周**：开发Web端数据可视化功能
4. **第7-8周**：开发微信小程序端基础功能
5. **第9-10周**：测试、优化和文档编写

**技术栈选择（初学者推荐）：**
- **后端**：Python + FastAPI（简单易学）
- **数据库**：MongoDB Community Edition（文档型数据库，易于使用）
- **Web前端**：原生HTML/CSS/JavaScript + Chart.js（无需学习框架）
- **小程序前端**：微信小程序原生框架 + WeUI（官方UI库）

### 7.4 常见问题解答

**Q1: 作为初学者，应该先实现哪些功能？**
A: 建议先实现核心数据功能：数据录入、存储、查询、基础图表。这些功能是系统的基础，其他功能可以在此基础上扩展。

**Q2: 微信小程序开发需要什么条件？**
A: 需要注册微信小程序账号（个人开发者免费），下载微信开发者工具（免费），配置服务器域名（需要HTTPS）。

**Q3: 小程序和Web端可以共享后端API吗？**
A: 可以。建议使用RESTful API，Web端和小程序端都通过HTTP请求调用同一个后端API。

**Q4: 哪些功能可以省略？**
A: 视频姿势分析、复杂的训练计划生成、高级数据可视化等功能可以省略，先实现核心数据功能。

**Q5: 如何降低开发难度？**
A: 使用成熟的开源库（如Chart.js、WeUI），参考官方文档和示例代码，分阶段实现功能，先实现MVP版本。

